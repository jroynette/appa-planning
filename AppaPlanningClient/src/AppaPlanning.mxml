<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   xmlns:local="*"
			   currentState="accueil"
			   width="1000" height="700" 
			   creationComplete="init(event)"
			   xmlns:reporting="org.appa.planning.ihm.reporting.*"
			   xmlns:saisietemps="org.appa.planning.ihm.saisietemps.*">
	
	<fx:Style source="style/Style.css"/>
	
	<fx:Script>
		<![CDATA[
			import flash.net.navigateToURL;
			
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			
			import org.appa.planning.util.UserContext;
			
			/* protected function button1_clickHandler(event:MouseEvent):void
			{
				if(this.currentState == 'accueil'){
					this.currentState = 'historique';
					this.gridDemandes.dataProvider = dataHisto;
				}else{
					this.currentState = 'accueil';
					this.gridDemandes.dataProvider = dataAccueil;
				}
				
			} */
			
			protected function init(event:FlexEvent):void
			{
				rootViewStack.selectedChild=accueil;
				currentState = "accueil";
				var loginPopup:LoginPopup = new LoginPopup();
				PopUpManager.addPopUp(loginPopup,this,true);
				PopUpManager.centerPopUp(loginPopup);
			}
			
			protected function disconnect(event:MouseEvent):void
			{
				UserContext.instance.user = null;
				init(event as FlexEvent);
			}
			
		]]>
	</fx:Script>
	
	<s:states>
		<s:State name="accueil"/>
		<s:State name="historique"/>
	</s:states>
	
	<s:transitions>
		<!--<s:Transition fromState="accueil" toState="historique">
			<s:Resize target="{panel}"/>
		</s:Transition>
		<s:Transition fromState="historique" toState="accueil">
			<s:Resize target="{panel}"/>
		</s:Transition>	-->
	</s:transitions>
	
	<fx:Declarations>
		
		<!--<s:ArrayList id="dataHisto">
			<fx:Object dataField1="14/10/2011 - 20/10/2011" dataField2="Congés" dataField3="En cours"></fx:Object>
			<fx:Object dataField1="10/09/2011" dataField2="RTT" dataField3="Validé"></fx:Object>
			<fx:Object dataField1="10/08/2011 (Après-Midi)" dataField2="RTT" dataField3="Refusé"></fx:Object>
			<fx:Object dataField1="10/05/2011" dataField2="RTT" dataField3="Refusé"></fx:Object>
			<fx:Object dataField1="10/04/2011" dataField2="Congés" dataField3="Refusé"></fx:Object>
			<fx:Object dataField1="10/03/2011" dataField2="RTT" dataField3="Validé"></fx:Object>
			<fx:Object dataField1="10/05/2011" dataField2="RTT" dataField3="Refusé"></fx:Object>
			<fx:Object dataField1="10/04/2011" dataField2="Congés" dataField3="Validé"></fx:Object>
			<fx:Object dataField1="10/03/2011" dataField2="RTT" dataField3="Refusé"></fx:Object>
			<fx:Object dataField1="10/02/2011" dataField2="RTT" dataField3="Validé"></fx:Object>
			<fx:Object dataField1="10/01/2011" dataField2="Congés" dataField3="Refusé"></fx:Object>
			<fx:Object dataField1="10/12/2010" dataField2="RTT" dataField3="Validé"></fx:Object>
		</s:ArrayList>-->
		
		<!--<s:ArrayList id="dataAccueil">
			<fx:Object dataField1="14/11/2011 - 20/10/2011" dataField2="Congés" dataField3="En cours"></fx:Object>
			<fx:Object dataField1="10/09/2011" dataField2="RTT" dataField3="Validé"></fx:Object>
			<fx:Object dataField1="10/08/2011 (Après-Midi)" dataField2="RTT" dataField3="Refusé"></fx:Object>
		</s:ArrayList>
		
		<s:ArrayList id="dataDemandes">
			<fx:Object periode="14/11/2011 - 20/10/2011" person="personne 1"></fx:Object>
			<fx:Object periode="12/11/2011" person="personne 2"></fx:Object>
			<fx:Object periode="12/11/2011 (Après-Midi)" person="personne 2"></fx:Object>
		</s:ArrayList>-->
		
		
	</fx:Declarations>
	
	<s:HGroup horizontalAlign="center" width="100%">
		
	
	<s:Image source="@Embed(source='assets/appa.png')"/>
	
	</s:HGroup>
	<!--<s:Rect width="100%" height="25">
		<s:fill>
			<s:SolidColor color="black"/>
		</s:fill>
	</s:Rect>-->
	
	<s:HGroup y="26" x="290" width="100%" height="25" fontWeight="bold" gap="20"
			  horizontalAlign="left" paddingLeft="20" verticalAlign="middle">
		<mx:LinkButton label="Accueil" click="rootViewStack.selectedChild=accueil"/>
	</s:HGroup>
	<s:HGroup width="100%" height="25" fontWeight="bold" gap="100" color="white"
			  horizontalAlign="center" verticalAlign="middle">
		<s:Label text="{UserContext.instance.user.prenom} {UserContext.instance.user.nom}" />
		<!--<s:Label text="Solde Congés : 14 jours (6)" toolTip="14 jours à poser - 6 jours en cours de validation"/>
		<s:Label text="Solde RTT : 3,5 jours" toolTip="3,5 jours à poser"/>-->
	</s:HGroup>
	<s:HGroup width="100%" height="25" fontWeight="bold" gap="10" y="26"
			  horizontalAlign="right" paddingRight="20" verticalAlign="middle">
		<mx:LinkButton label="Deconnexion" click="disconnect(event)"/>
	</s:HGroup>
	
	<mx:ViewStack id="rootViewStack" width="100%" height="100%" paddingBottom="10" paddingLeft="10"
				  paddingRight="10" paddingTop="120">
		
		
		
		<s:NavigatorContent id="accueil">
				
		<s:HGroup width="100%" height="100%">
			
			<s:VGroup width="50%" height="100%" paddingLeft="100" verticalAlign="middle" gap="50" >
				
<!--				<s:Panel id="panel" width="100%" height="233" title="Demandes en cours"
						 height.historique="400" title.historique="Historique des demandes" visible="{user=='Aurore Deconinck'}" includeInLayout="{user=='Aurore Deconinck'}">
					
					<s:VGroup width="100%" height="100%" paddingBottom="10" paddingLeft="10"
							  paddingRight="10" paddingTop="10">
						<s:DataGrid id="gridDemandes" width="100%" height="90%"
									dataProvider="{dataAccueil}">
							<s:columns>
								<s:ArrayList>
									<s:GridColumn dataField="dataField1" headerText="Date"></s:GridColumn>
									<s:GridColumn width="100" dataField="dataField2"
												  headerText="Type"></s:GridColumn>
									<s:GridColumn width="100" dataField="dataField3"
												  headerText="Etat"></s:GridColumn>
								</s:ArrayList>
							</s:columns>
							<s:typicalItem>
								<fx:Object dataField1="Sample Data" dataField2="Sample Data"
										   dataField3="Sample Data"></fx:Object>
							</s:typicalItem>
						</s:DataGrid>
						<s:HGroup width="100%" horizontalAlign="center">
							<s:Button label="Historique des demandes"
									  click="button1_clickHandler(event)"
									  label.historique="Demandes en cours"/>
						</s:HGroup>
					</s:VGroup>
				</s:Panel>
				
				<s:Panel id="panel2" width="100%" height="200" title="Demandes à traiter" visible="{user=='Corinne ...'}" includeInLayout="{user=='Corinne ...'}" >
					<s:VGroup width="100%" height="100%" paddingBottom="10" paddingLeft="10"
							  paddingRight="10" paddingTop="10">
						<s:DataGrid id="gridDemandes2" width="100%" height="90%"
									dataProvider="{dataDemandes}">
							<s:columns>
								<s:ArrayList>
									<s:GridColumn width="100" dataField="person"
												  headerText="Personne"></s:GridColumn>
									<s:GridColumn dataField="periode" headerText="Période"></s:GridColumn>
									<s:GridColumn width="30">
										<s:itemRenderer>
											<fx:Component>
												<s:GridItemRenderer>
												<s:HGroup horizontalAlign="center"
														  verticalAlign="middle">
													<s:Image source="@Embed(source='assets/tick.jpg')" width="20" height="20" toolTip="accepter"/>
												</s:HGroup>
												</s:GridItemRenderer>
											</fx:Component>
										</s:itemRenderer>
									</s:GridColumn>
									<s:GridColumn width="30">
										<s:itemRenderer>
											<fx:Component>
												<s:GridItemRenderer>
													<s:HGroup horizontalAlign="center"
															  verticalAlign="middle">
														<s:Image source="@Embed(source='assets/delete.jpg')" width="20" height="20" toolTip="refuser"/>
													</s:HGroup>
												</s:GridItemRenderer>
											</fx:Component>
										</s:itemRenderer>
									</s:GridColumn>
								</s:ArrayList>
							</s:columns>
						</s:DataGrid>
					</s:VGroup>
				</s:Panel>
				
				<s:Panel id="panel3" width="100%" title="Tickets restaurant (20 disponibles)" >
					<s:HGroup width="100%" height="100%" paddingBottom="10" paddingLeft="10"
							  paddingRight="10" paddingTop="10" verticalAlign="middle" horizontalAlign="center">
						<s:NumericStepper minimum="0" maximum="20" value="20"/>
						<s:Button label="Commander"/>
					</s:HGroup>
					
				</s:Panel>-->
				
			</s:VGroup>
			
			<s:HGroup width="40%" height="100%" horizontalAlign="center"
					  verticalAlign="middle">
				<s:TileGroup  requestedRowCount="2" horizontalGap="10" verticalGap="10">
					<s:Image width="102" height="102" buttonMode="true"
							 source="@Embed(source='assets/calendar.jpg')" toolTip="gérer mes congés"/>
					<s:Image width="102" height="102" buttonMode="true"
							 source="@Embed(source='assets/horloge.png')" toolTip="saisir mes temps"
							 click="rootViewStack.selectedChild=saisieTemps; saisieTemps.init(event)"/>
					<s:Image buttonMode="true"
							 click="rootViewStack.selectedChild=reporting; reporting.init(event)"
							 source="@Embed(source='assets/reporting.jpg')" toolTip="voir le reporting"/>
					<s:Image width="102" height="102" buttonMode="true"
							 source="@Embed(source='assets/Config-Tools.png')"
							 toolTip="paramétrer l'application" click="navigateToURL(new URLRequest('http://appaplanningadmin.cloudfoundry.com/'))"/>
					
				</s:TileGroup>
			</s:HGroup>
			
			
		</s:HGroup>
		</s:NavigatorContent>
		
		<reporting:Reporting id="reporting"/>
		<saisietemps:SaisieTemps id="saisieTemps"/>
		
		<!--<planning:Planning id="planning" width="100%" height="100%"/>-->
		
		<!--<local:SaisieProjets id="saisieTemps"/>-->
		
	</mx:ViewStack>
	
</s:WindowedApplication>
